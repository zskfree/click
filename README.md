# 按键精灵项目

## 项目简介

按键精灵项目是一个基于Python的自动化工具，能够记录和回放鼠标点击，并通过图像识别进行自动点击。该项目使用了多个Python库，如`tkinter`用于图形用户界面，`pynput`用于鼠标事件监听，`pyautogui`用于屏幕截图和鼠标控制，`opencv`用于图像处理。

## 功能特性

- **点击记录与回放**：记录鼠标点击位置并按设定的间隔时间回放。
- **图像识别点击**：通过图像识别在屏幕上找到指定的图像并进行点击。
- **参数配置**：提供图形界面配置点击速度、相似度阈值、等待时间、是否立即点击等参数。
- **循环执行**：支持设定循环次数，自动执行多次点击任务。

## 项目结构

```
click/
├── src/                      # 源代码目录
│   ├── core/                # 核心功能模块
│   ├── ui/                  # UI模块
│   ├── config/              # 配置管理
│   └── utils/               # 工具函数
├── templates/               # 模板资源
│   └── png/                 # 图像模板目录
├── data/                    # 数据目录
│   └── logs/                # 日志存储
├── tests/                   # 测试代码
├── docs/                    # 文档
├── main.py                  # 程序入口
├── config.json              # 配置文件
├── requirements.txt         # 依赖列表
└── README.md                # 本文件
```

详见 [项目结构说明](./docs/PROJECT_STRUCTURE.md)

## 文件说明

- `main.py`：主程序文件，包含图形用户界面和主要逻辑。
- `src/core/`：核心模块，包含点击记录、图像识别等功能。
- `src/ui/`：UI模块，提供配置界面。
- `src/config/`：配置管理模块。
- `src/utils/`：工具函数，包括日志配置等。
- `templates/png/`：存放图像模板文件。
- `data/logs/`：存放日志文件。
- `docs/`：项目文档。

## 安装与运行

### 环境依赖

请确保已安装以下Python库：

- `pyinstaller`：用于打包成exe
- `opencv-python-headless`：图像处理
- `numpy`：数值计算
- `pyautogui`：鼠标和键盘控制
- `pynput`：鼠标监听
- `pillow`：图像处理
- `tkinter`：GUI（通常随Python一起安装）

可以通过以下命令安装依赖：

```bash
pip install -r requirements.txt
```

### 运行项目

#### 方式1：直接运行

```bash
python main.py
```

#### 方式2：双击启动脚本（Windows）

```bash
启动.bat
```

## 使用指南

### 快速开始

1. 在 `templates/png/` 目录下放入你的模板图像（PNG格式）
2. 运行 `python main.py`
3. 使用 GUI 界面进行操作

### 功能说明

详见 [使用指南](./docs/USAGE.md)

### API 参考

详见 [API 文档](./docs/API.md)

## 配置说明

配置文件位置：`src/config/config.json`

| 参数 | 说明 | 默认值 |
|-----|-----|-------|
| `png_dir` | 图片模板目录 | `templates/png` |
| `click_interval` | 点击间隔（秒） | `1.0` |
| `loop_times` | 循环次数 | `1` |
| `threshold` | 相似度阈值 | `0.8` |
| `wait_time` | 等待时间（秒） | `1.0` |
| `immediate_click` | 是否立即点击 | `false` |
| `log_level` | 日志级别 | `INFO` |
| `log_file` | 日志文件路径 | `data/logs/app.log` |

## 快捷键

| 快捷键 | 功能 |
|-------|------|
| ESC | 全局停止 |

## 开发指南

### 项目架构

本项目采用模块化设计：

- **core**: 核心功能（点击记录、图像识别）
- **ui**: 用户界面（配置窗口）
- **config**: 配置管理
- **utils**: 工具函数

### 扩展开发

参考 [项目结构说明](./docs/PROJECT_STRUCTURE.md) 和 [API 文档](./docs/API.md)

## 注意事项

⚠️ **重要提示**：

- 自动点击会真实控制鼠标，请在测试环境中运行
- 在虚拟机或专门的测试屏幕上测试
- 备份重要数据，防止误操作
- 使用 ESC 键可以随时停止执行

## 故障排除

### 模板识别失败

- 查看 `data/logs/app.log` 获取详细信息
- 检查 `templates/png/` 目录中的图像文件
- 调整 "相似度阈值"，重新尝试

### 程序无法启动

```bash
# 重新安装依赖
pip install -r requirements.txt --upgrade

# 检查 Python 版本（需要 3.7+）
python --version
```

## 许可证

此项目仅供学习和研究使用。

## 联系方式

如有问题或建议，请提交 Issue 或 PR。

---

**最后更新**: 2026年1月13日

## 使用说明

### 主界面

- **开始记录点击**：点击按钮开始记录鼠标点击位置。
- **停止记录点击**：点击按钮停止记录鼠标点击位置。
- **播放点击**：点击按钮按设定的循环次数回放记录的点击。
- **开始图片识别点击**：点击按钮开始图像识别并自动点击。
- **停止图片识别点击**：点击按钮停止图像识别点击。
- **配置参数**：点击按钮打开配置界面，设置点击速度、相似度阈值、等待时间、是否立即点击和循环次数。

### 配置界面

- **点击速度**：设置点击间隔时间（秒）。
- **相似度阈值**：设置图像识别的相似度阈值。
- **等待时间**：设置图像识别的等待时间（秒）。
- **立即点击**：设置是否立即点击找到的图像。
- **循环次数**：设置点击任务的循环次数。
- **保存配置**：保存当前配置参数。

## 日志记录

项目运行过程中会生成日志文件`app.log`，记录各类操作和错误信息，便于调试和维护。

## 贡献

欢迎提交问题和贡献代码！请确保在提交PR之前阅读并遵循项目的贡献指南。

## 许可证

本项目采用MIT许可证，详情请参阅LICENSE文件。
